!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=13)}([function(e,t,n){"use strict";const o=e=>{window.addEventListener("message",t=>{let n=t.source,o=null;try{o=JSON.parse(t.data)}catch(e){return}e(o,n)})},r=e=>{browser.runtime.onMessage.addListener(e)};t.a={BACKGROUND_OPERATION:"background.operation",CONSOLE_UNFOCUS:"console.unfocus",CONSOLE_ENTER_COMMAND:"console.enter.command",CONSOLE_ENTER_FIND:"console.enter.find",CONSOLE_QUERY_COMPLETIONS:"console.query.completions",CONSOLE_SHOW_COMMAND:"console.show.command",CONSOLE_SHOW_ERROR:"console.show.error",CONSOLE_SHOW_INFO:"console.show.info",CONSOLE_SHOW_FIND:"console.show.find",CONSOLE_HIDE:"console.hide",FOLLOW_START:"follow.start",FOLLOW_REQUEST_COUNT_TARGETS:"follow.request.count.targets",FOLLOW_RESPONSE_COUNT_TARGETS:"follow.response.count.targets",FOLLOW_CREATE_HINTS:"follow.create.hints",FOLLOW_SHOW_HINTS:"follow.update.hints",FOLLOW_REMOVE_HINTS:"follow.remove.hints",FOLLOW_ACTIVATE:"follow.activate",FOLLOW_KEY_PRESS:"follow.key.press",FIND_NEXT:"find.next",FIND_PREV:"find.prev",FIND_GET_KEYWORD:"find.get.keyword",FIND_SET_KEYWORD:"find.set.keyword",ADDON_ENABLED_QUERY:"addon.enabled.query",ADDON_ENABLED_RESPONSE:"addon.enabled.response",ADDON_TOGGLE_ENABLED:"addon.toggle.enabled",OPEN_URL:"open.url",SETTINGS_RELOAD:"settings.reload",SETTINGS_CHANGED:"settings.changed",SETTINGS_QUERY:"settings.query",onWebMessage:o,onBackgroundMessage:r,onMessage:e=>{o(e),r(e)}}},,,,,function(e,t,n){var o,r,i={},s=(o=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===r&&(r=o.apply(this,arguments)),r}),c=function(e){var t={};return function(e){if("function"==typeof e)return e();if(void 0===t[e]){var n=function(e){return document.querySelector(e)}.call(this,e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}}(),a=null,l=0,p=[],d=n(10);function u(e,t){for(var n=0;n<e.length;n++){var o=e[n],r=i[o.id];if(r){r.refs++;for(var s=0;s<r.parts.length;s++)r.parts[s](o.parts[s]);for(;s<o.parts.length;s++)r.parts.push(S(o.parts[s],t))}else{var c=[];for(s=0;s<o.parts.length;s++)c.push(S(o.parts[s],t));i[o.id]={id:o.id,refs:1,parts:c}}}}function m(e,t){for(var n=[],o={},r=0;r<e.length;r++){var i=e[r],s=t.base?i[0]+t.base:i[0],c={css:i[1],media:i[2],sourceMap:i[3]};o[s]?o[s].parts.push(c):n.push(o[s]={id:s,parts:[c]})}return n}function O(e,t){var n=c(e.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var o=p[p.length-1];if("top"===e.insertAt)o?o.nextSibling?n.insertBefore(t,o.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),p.push(t);else if("bottom"===e.insertAt)n.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var r=c(e.insertInto+" "+e.insertAt.before);n.insertBefore(t,r)}}function f(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=p.indexOf(e);t>=0&&p.splice(t,1)}function h(e){var t=document.createElement("style");return void 0===e.attrs.type&&(e.attrs.type="text/css"),E(t,e.attrs),O(e,t),t}function E(e,t){Object.keys(t).forEach(function(n){e.setAttribute(n,t[n])})}function S(e,t){var n,o,r,i;if(t.transform&&e.css){if(!(i=t.transform(e.css)))return function(){};e.css=i}if(t.singleton){var s=l++;n=a||(a=h(t)),o=N.bind(null,n,s,!1),r=N.bind(null,n,s,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",E(t,e.attrs),O(e,t),t}(t),o=function(e,t,n){var o=n.css,r=n.sourceMap,i=void 0===t.convertToAbsoluteUrls&&r;(t.convertToAbsoluteUrls||i)&&(o=d(o));r&&(o+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var s=new Blob([o],{type:"text/css"}),c=e.href;e.href=URL.createObjectURL(s),c&&URL.revokeObjectURL(c)}.bind(null,n,t),r=function(){f(n),n.href&&URL.revokeObjectURL(n.href)}):(n=h(t),o=function(e,t){var n=t.css,o=t.media;o&&e.setAttribute("media",o);if(e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}.bind(null,n),r=function(){f(n)});return o(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;o(e=t)}else r()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=s()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var n=m(e,t);return u(n,t),function(e){for(var o=[],r=0;r<n.length;r++){var s=n[r];(c=i[s.id]).refs--,o.push(c)}e&&u(m(e,t),t);for(r=0;r<o.length;r++){var c;if(0===(c=o[r]).refs){for(var a=0;a<c.parts.length;a++)c.parts[a]();delete i[c.id]}}}};var v,g=(v=[],function(e,t){return v[e]=t,v.filter(Boolean).join("\n")});function N(e,t,n,o){var r=n?"":o.css;if(e.styleSheet)e.styleSheet.cssText=g(t,r);else{var i=document.createTextNode(r),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(i,s[t]):e.appendChild(i)}}},function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n=function(e,t){var n=e[1]||"",o=e[3];if(!o)return n;if(t&&"function"==typeof btoa){var r=(s=o,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */"),i=o.sources.map(function(e){return"/*# sourceURL="+o.sourceRoot+e+" */"});return[n].concat(i).concat([r]).join("\n")}var s;return[n].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+n+"}":n}).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var o={},r=0;r<this.length;r++){var i=this[r][0];"number"==typeof i&&(o[i]=!0)}for(r=0;r<e.length;r++){var s=e[r];"number"==typeof s[0]&&o[s[0]]||(n&&!s[2]?s[2]=n:n&&(s[2]="("+s[2]+") and ("+n+")"),t.push(s))}},t}},,function(e,t,n){"use strict";n.d(t,"a",function(){return o});const o=(e,t=(()=>{}))=>new class{constructor(e,t){this.reducer=e,this.catcher=t,this.subscribers=[];try{this.state=this.reducer(void 0,{})}catch(e){t(e)}}dispatch(e,t){if(e instanceof Promise)e.then(e=>{this.transitNext(e,t)}).catch(e=>{this.catcher(e,t)});else try{this.transitNext(e,t)}catch(e){this.catcher(e,t)}return e}getState(){return this.state}subscribe(e){this.subscribers.push(e)}transitNext(e,t){let n=this.reducer(this.state,e);JSON.stringify(this.state)!==JSON.stringify(n)&&(this.state=n,this.subscribers.forEach(e=>e(t)))}}(e,t)},,function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var n=t.protocol+"//"+t.host,o=n+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(e,t){var r,i=t.trim().replace(/^"(.*)"$/,function(e,t){return t}).replace(/^'(.*)'$/,function(e,t){return t});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(i)?e:(r=0===i.indexOf("//")?i:0===i.indexOf("/")?n+i:o+i.replace(/^\.\//,""),"url("+JSON.stringify(r)+")")})}},,,function(e,t,n){"use strict";n.r(t);n(18);var o=n(0);var r={CONSOLE_HIDE:"console.hide",CONSOLE_SHOW_COMMAND:"console.show.command",CONSOLE_SHOW_ERROR:"console.show.error",CONSOLE_SHOW_INFO:"console.show.info",CONSOLE_HIDE_COMMAND:"console.hide.command",CONSOLE_SET_CONSOLE_TEXT:"console.set.command",CONSOLE_SET_COMPLETIONS:"console.set.completions",CONSOLE_COMPLETION_NEXT:"console.completion.next",CONSOLE_COMPLETION_PREV:"console.completion.prev",CONSOLE_SHOW_FIND:"console.show.find"};const i=()=>({type:r.CONSOLE_HIDE_COMMAND}),s=e=>({type:r.CONSOLE_SET_CONSOLE_TEXT,consoleText:e}),c=(e,t)=>({type:r.CONSOLE_SET_COMPLETIONS,completionSource:e,completions:t}),a=()=>({type:r.CONSOLE_COMPLETION_NEXT}),l=()=>({type:r.CONSOLE_COMPLETION_PREV}),p=e=>["command","find"].includes(e.mode);const d={mode:"",messageText:"",consoleText:"",completionSource:"",completions:[],groupSelection:-1,itemSelection:-1},u=e=>{if(e.groupSelection<0)return[0,0];let t=e.completions[e.groupSelection];return e.groupSelection+1>=e.completions.length&&e.itemSelection+1>=t.items.length?[-1,-1]:e.itemSelection+1>=t.items.length?[e.groupSelection+1,0]:[e.groupSelection,e.itemSelection+1]},m=e=>e.groupSelection<0?[e.completions.length-1,e.completions[e.completions.length-1].items.length-1]:0===e.groupSelection&&0===e.itemSelection?[-1,-1]:0===e.itemSelection?[e.groupSelection-1,e.completions[e.groupSelection-1].items.length-1]:[e.groupSelection,e.itemSelection-1],O=(e,t,n,o)=>t<0||n<0?o:e[t].items[n].content;var f=n(8);const h=Object(f.a)(function(e=d,t={}){switch(t.type){case r.CONSOLE_HIDE:return Object.assign({},e,{mode:""});case r.CONSOLE_SHOW_COMMAND:return Object.assign({},e,{mode:"command",consoleText:t.text,completions:[]});case r.CONSOLE_SHOW_FIND:return Object.assign({},e,{mode:"find",consoleText:"",completions:[]});case r.CONSOLE_SHOW_ERROR:return Object.assign({},e,{mode:"error",messageText:t.text});case r.CONSOLE_SHOW_INFO:return Object.assign({},e,{mode:"info",messageText:t.text});case r.CONSOLE_HIDE_COMMAND:return Object.assign({},e,{mode:"command"===e.mode||"find"===e.mode?"":e.mode});case r.CONSOLE_SET_CONSOLE_TEXT:return Object.assign({},e,{consoleText:t.consoleText});case r.CONSOLE_SET_COMPLETIONS:return Object.assign({},e,{completions:t.completions,completionSource:t.completionSource,groupSelection:-1,itemSelection:-1});case r.CONSOLE_COMPLETION_NEXT:{let t=u(e);return Object.assign({},e,{groupSelection:t[0],itemSelection:t[1],consoleText:O(e.completions,t[0],t[1],e.completionSource)})}case r.CONSOLE_COMPLETION_PREV:{let t=m(e);return Object.assign({},e,{groupSelection:t[0],itemSelection:t[1],consoleText:O(e.completions,t[0],t[1],e.completionSource)})}default:return e}});window.addEventListener("load",()=>{new class{constructor(e,t){this.wrapper=e,this.store=t,this.prevState={},t.subscribe(()=>{this.update()})}update(){let e=this.store.getState();if(JSON.stringify(this.prevState)!==JSON.stringify(e)){this.wrapper.innerHTML="";for(let t=0;t<e.completions.length;++t){let n=e.completions[t],o=this.createCompletionTitle(n.name);this.wrapper.append(o);for(let o=0;o<n.items.length;++o){let r=n.items[o],i=this.createCompletionItem(r.icon,r.caption,r.url);this.wrapper.append(i),t===e.groupSelection&&o===e.itemSelection&&i.classList.add("vimvixen-completion-selected")}}this.prevState=e}}createCompletionTitle(e){let t=this.wrapper.ownerDocument.createElement("li");return t.className="vimvixen-console-completion-title",t.textContent=e,t}createCompletionItem(e,t,n){let o=this.wrapper.ownerDocument,r=o.createElement("span");r.className="vimvixen-console-completion-item-caption",r.textContent=t;let i=o.createElement("span");i.className="vimvixen-console-completion-item-url",i.textContent=n;let s=o.createElement("li");return s.style.backgroundImage="url("+e+")",s.className="vimvixen-console-completion-item",s.append(r),s.append(i),s}}(document.querySelector("#vimvixen-console-completion"),h),new class{constructor(e,t){this.wrapper=e,this.store=t,this.prevMode="";let n=this.wrapper.ownerDocument.querySelector("#vimvixen-console-command-input");n.addEventListener("blur",this.onBlur.bind(this)),n.addEventListener("keydown",this.onKeyDown.bind(this)),n.addEventListener("input",this.onInput.bind(this)),t.subscribe(()=>{this.update()}),this.update()}onBlur(){"command"===this.store.getState().mode&&this.hideCommand()}doEnter(e){return e.stopPropagation(),e.preventDefault(),this.onEntered(e.target.value)}selectNext(e){this.store.dispatch(a()),e.stopPropagation(),e.preventDefault()}selectPrev(e){this.store.dispatch(l()),e.stopPropagation(),e.preventDefault()}onKeyDown(e){if(e.keyCode===KeyboardEvent.DOM_VK_ESCAPE&&e.ctrlKey)return this.hideCommand();switch(e.keyCode){case KeyboardEvent.DOM_VK_ESCAPE:return this.hideCommand();case KeyboardEvent.DOM_VK_RETURN:return this.doEnter(e);case KeyboardEvent.DOM_VK_TAB:e.shiftKey?this.store.dispatch(l()):this.store.dispatch(a()),e.stopPropagation(),e.preventDefault();break;case KeyboardEvent.DOM_VK_OPEN_BRACKET:if(e.ctrlKey)return this.hideCommand();break;case KeyboardEvent.DOM_VK_M:if(e.ctrlKey)return this.doEnter(e);break;case KeyboardEvent.DOM_VK_N:e.ctrlKey&&this.selectNext(e);break;case KeyboardEvent.DOM_VK_P:e.ctrlKey&&this.selectPrev(e)}}onEntered(e){let t=this.store.getState();"command"===t.mode?(browser.runtime.sendMessage({type:o.a.CONSOLE_ENTER_COMMAND,text:e}),this.hideCommand()):"find"===t.mode&&(this.hideCommand(),window.top.postMessage(JSON.stringify({type:o.a.CONSOLE_ENTER_FIND,text:e}),"*"))}async onInput(e){this.store.dispatch(s(e.target.value));let t=e.target.value,n=await browser.runtime.sendMessage({type:o.a.CONSOLE_QUERY_COMPLETIONS,text:t});this.store.dispatch(c(t,n))}onInputShown(e){let t=this.wrapper.ownerDocument.querySelector("#vimvixen-console-command-input");t.focus(),window.focus(),"command"===e.mode&&this.onInput({target:t})}hideCommand(){this.store.dispatch(i()),window.top.postMessage(JSON.stringify({type:o.a.CONSOLE_UNFOCUS}),"*")}update(){let e=this.store.getState();this.updateMessage(e),this.updateCommand(e),this.updatePrompt(e),this.prevMode!==e.mode&&p(e)&&this.onInputShown(e),this.prevMode=e.mode}updateMessage(e){let t=this.wrapper.ownerDocument.querySelector(".vimvixen-console-message"),n="none",o=["vimvixen-console-message"];"error"!==e.mode&&"info"!==e.mode||(n="block",o.push("vimvixen-console-"+e.mode)),t.className=o.join(" "),t.style.display=n,t.textContent=e.messageText}updateCommand(e){let t=this.wrapper.ownerDocument,n=t.querySelector("#vimvixen-console-command"),o=t.querySelector("#vimvixen-console-command-input"),r="none";p(e)&&(r="block"),n.style.display=r,o.value=e.consoleText}updatePrompt(e){let t=["vimvixen-console-command-prompt"];p(e)&&t.push("prompt-"+e.mode),this.wrapper.ownerDocument.querySelector(".vimvixen-console-command-prompt").className=t.join(" ")}}(document.body,h)});const E=e=>{switch(e.type){case o.a.CONSOLE_SHOW_COMMAND:return h.dispatch((e=>({type:r.CONSOLE_SHOW_COMMAND,text:e}))(e.command));case o.a.CONSOLE_SHOW_FIND:return h.dispatch((()=>({type:r.CONSOLE_SHOW_FIND}))());case o.a.CONSOLE_SHOW_ERROR:return h.dispatch((e=>({type:r.CONSOLE_SHOW_ERROR,text:e}))(e.text));case o.a.CONSOLE_SHOW_INFO:return h.dispatch((e=>({type:r.CONSOLE_SHOW_INFO,text:e}))(e.text));case o.a.CONSOLE_HIDE:return h.dispatch((()=>({type:r.CONSOLE_HIDE}))())}};browser.runtime.onMessage.addListener(E),window.addEventListener("message",e=>{E(JSON.parse(e.data))},!1)},,,,function(e,t,n){(e.exports=n(6)(!1)).push([e.i,"html, body, * {\n  margin: 0;\n  padding: 0; }\n\nbody {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  overflow: hidden; }\n\n.vimvixen-console {\n  bottom: 0;\n  margin: 0;\n  padding: 0; }\n  .vimvixen-console-command-wrapper {\n    border-top: 1px solid gray; }\n  .vimvixen-console-completion {\n    background-color: white;\n    font-style: normal;\n    font-family: monospace;\n    font-size: 12px;\n    line-height: 16px; }\n    .vimvixen-console-completion-title {\n      background-color: lightgray;\n      font-weight: bold;\n      margin: 0;\n      padding: 0; }\n    .vimvixen-console-completion-item {\n      padding-left: 1.5rem;\n      background-position: 0 center;\n      background-size: contain;\n      background-repeat: no-repeat;\n      white-space: nowrap; }\n      .vimvixen-console-completion-item.vimvixen-completion-selected {\n        background-color: yellow; }\n      .vimvixen-console-completion-item-caption {\n        display: inline-block;\n        width: 40%;\n        text-overflow: ellipsis;\n        overflow: hidden; }\n      .vimvixen-console-completion-item-url {\n        display: inline-block;\n        color: green;\n        width: 60%;\n        text-overflow: ellipsis;\n        overflow: hidden; }\n  .vimvixen-console-message {\n    font-style: normal;\n    font-family: monospace;\n    font-size: 12px;\n    line-height: 16px;\n    border-top: 1px solid gray; }\n  .vimvixen-console-error {\n    background-color: red;\n    font-weight: bold;\n    color: white; }\n  .vimvixen-console-info {\n    background-color: white;\n    font-weight: normal;\n    color: green; }\n  .vimvixen-console-command {\n    background-color: white;\n    display: flex; }\n    .vimvixen-console-command-prompt:before {\n      font-style: normal;\n      font-family: monospace;\n      font-size: 12px;\n      line-height: 16px; }\n    .vimvixen-console-command-prompt.prompt-command:before {\n      content: ':'; }\n    .vimvixen-console-command-prompt.prompt-find:before {\n      content: '/'; }\n    .vimvixen-console-command-input {\n      border: none;\n      flex-grow: 1;\n      font-style: normal;\n      font-family: monospace;\n      font-size: 12px;\n      line-height: 16px; }\n",""])},function(e,t,n){var o=n(17);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(5)(o,r);o.locals&&(e.exports=o.locals)}]);